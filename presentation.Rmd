---
title: "Analiza adaptacji studentów do nauki zdalnej"
author: |
  | Krawiec Piotr
  | Inżynieria i analiza danych, 3 Rok
date: "29/12/2021"
output:
  beamer_presentation:
    theme: Antibes
    keep_tex: yes
  slidy_presentation: 
    theme: united
    highlight: tango
description: Inżynieria i analiza danych, 3 Rok
header-includes: \usepackage{animate}
subtitle: "z pomocą sieci bayesowskiej"
lang: pl
always_allow_html: true
---

```{r setup, include=FALSE, warning=FALSE}
library(knitr)
hook_output <- knit_hooks$get("output")
knit_hooks$set(output = function(x, options) {
  lines <- options$output.lines
  if (is.null(lines)) {
    return(hook_output(x, options))  # pass to default hook
  }
  x <- unlist(strsplit(x, "\n"))
  more <- "..."
  if (length(lines)==1) {        # first n lines
    if (length(x) > lines) {
      # truncate the output, but add ....
      x <- c(head(x, lines), more)
    }
  } else {
    x <- c(more, x[lines], more)
  }                                                         
  # paste these lines together                              
  x <- paste(c(x, ""), collapse = "\n")                     
  hook_output(x, options)                                   
})                                                          
knitr::opts_chunk$set(echo = TRUE)                          
knitr::opts_chunk$set(cache = TRUE) 
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
# Chunk options
knitr::opts_chunk$set(
 fig.width = 6,
 fig.asp = 0.8,
 out.width = "80%"
)
Sys.setlocale("LC_ALL", "Polish")


theme_ben <- function(base_size = 18) {
  theme_bw(base_size = base_size) %+replace%
    theme(
      # L'ensemble de la figure
      plot.title = element_text(size = rel(1), face = "bold", margin = margin(0,0,5,0), hjust = 0),
      # Zone où se situe le graphique
      panel.grid.minor = element_blank(),
      panel.border = element_blank(),
      # Les axes
      axis.title = element_text(size = rel(0.85), face = "bold"),
      axis.text = element_text(size = rel(0.70), face = "bold"),
      axis.line = element_line(color = "black", arrow = arrow(length = unit(0.3, "lines"), type = "closed")),
      # La légende
      legend.title = element_text(size = rel(0.85), face = "bold"),
      legend.text = element_text(size = rel(0.70), face = "bold"),
      legend.key = element_rect(fill = "transparent", colour = NA),
      legend.key.size = unit(1.5, "lines"),
      legend.background = element_rect(fill = "transparent", colour = NA),
      # Les étiquettes dans le cas d'un facetting
      strip.background = element_rect(fill = "#17252D", color = "#17252D"),
      strip.text = element_text(size = rel(0.85), face = "bold", color = "white", margin = margin(5,0,5,0))
    )
}

library(ggplot2)

# Changing the default theme
theme_set(theme_ben())
```

# Wstęp

W roku 2020 większość placówek edukacyjnych rozpoczęła naukę w formie zdalnej.
Spowodowało to wiele trudności zarówno po stronie uczniów jak i prowadzących. 
Celem tej pracy jest analiza czynników, które miały wpływ na dopasowanie się 
uczniów do nowej sytuacji z pomocą sieci bayesowskiej.

# Agenda

- Dane

- Tworzenie struktury sieci

- Analizy

# Dane

Dane to zbiór zawierający wyłącznie dane kategoryczne (factors w R). I składa się
z kolumn:

- Gender (Girl/Boy) - płeć ucznia
- Age (1 to 5/6-10/11-15/16-20/21-25/26-30/30+) - przedział wiekowy
- Education.Level (School/College/University) - poziom edukacji
- Institution.Type (Non Government/Government) - typ szkoły
- IT.Student (Yes/No) - czy to student IT
- Location (Yes/No) - czy uczy się i mieszka w tym samym mieście
- Load.shedding (Low/High) - niestabilność sieci elektrycznej, częstotliwość zaników prądu

# Dane

- Financial.Condition (Poor/Mid/Rich) - kondycja finansowa ucznia
- Internet.Type(2G/3G/4G) - rodzaj połączenia internetowego wykorzystywanego do nauki
- Device (Tab/Mobile/Computer) - urządzenie wykorzystywane podczas zajęć
- Network.Type (Mobile Data/Wifi) - rodzaj połączenia z internetem
- Class.Duration (0/1-3/3-6 hours) - ilość godzin lekcyjnych dziennie
- Self.Lms (Yes/No) - czy szkoła ma własny e-learning
- Adaptivity.Level (Low/Moderate/High) - poziom adaptacji ucznia

# Załadowanie danych w R

```{r, message=FALSE, error=FALSE, warning=FALSE}
library(tidyverse)
library(tibble)
library(bnlearn)
library(lattice)
library(Rgraphviz)

df <- read.csv("datasets/dataset.csv")
col_names <- names(df)
df[] <- lapply(df[col_names], as.factor)
```

# Wizualizacje

```{r, echo=FALSE}
ggplot(df, aes(`Age`)) +
  geom_bar() +
  scale_x_discrete(drop = FALSE)
```

# Wizualizacje

```{r, echo=FALSE}
ggplot(df, aes(`Gender`)) +
  geom_bar() +
  scale_x_discrete(drop = FALSE)
```

# Wizualizacje

```{r, echo=FALSE}
ggplot(df, aes(`Education.Level`)) +
  geom_bar() +
  scale_x_discrete(drop = FALSE)
```

# Wizualizacje

```{r, echo=FALSE}
ggplot(df, aes(Adaptivity.Level)) +
  geom_bar() +
  scale_x_discrete(drop = FALSE)
```



















